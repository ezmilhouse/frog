!function(){var e=!1,t=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(n){function r(){!e&&this[s]&&this[s].apply(this,arguments)}var s="_ctor",i=this.prototype;e=!0;var o=new this;e=!1;for(var a in n)o[a]="function"==typeof n[a]&&"function"==typeof i[a]&&t.test(n[a])?function(e,t){return function(){var n=this._super;this._super=i[e];var r=t.apply(this,arguments);return this._super=n,r}}(a,n[a]):n[a];return r.prototype=o,r.prototype.constructor=r,r.extend=arguments.callee,r}}(),define("src/Inherit",function(){}),define("src/util",["moment","numeral"],function(e,t){var n={codes:{200:"OK",201:"OK_CREATED",202:"OK_ACCEPTED",204:"OK_NO_CONTENT",400:"ERROR_BAD_REQUEST",401:"ERROR_UNAUTHORIZED",403:"ERROR_FORBIDDEN",404:"ERROR_NOT_FOUND",409:"ERROR_CONFLICT",500:"ERROR_INTERNAL_SERVER_ERROR"},date:{formats:{iso:"YYYY-MM-DDTHH:mm:ss.sss",local:{de:"DD.MM.YYYY - HH:mm:ss",de_day:"DD.MM.YYYY"},utc:"MM-DD-YYYY HH:mm:ss ZZ",utcutc:"ddd MMM DD YYYY HH:mm:ss.sss ZZ",utc_parse:"ddd MMM DD YYYY HH:mm:ss.sss ZZ"},local:function(t,r){return r=r||"de",r=n.date.formats.local[r],e(t).local().format(r)},utc:function(){return e.utc().format(n.date.formats.utc)},utcLocal:function(t,r){return t?e.utc(t,r).local().format(n.date.formats.utc):e.utc().local().format(n.date.formats.utc)}},hash:{sha1:function(e){return crypto.createHash("sha1").update(e).digest("hex")}},moment:e,trim:function(e){return"undefined"==typeof e?e:(e=e.toString(),"undefined"!=typeof $?$.trim(e):e.replace(/^\s+|\s+$/gm,""))},guid:function(e){e=e||1;for(var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},n=function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},r=[],s=0;e>s;s++)r.push(n());return r},KEYCODE_ESC:27,calc:{timeDiff:function(e){for(var t=4,n=[],r=0;r<e.length;r++)n.push(r-1>=0?((e[r].time-e[r-1].time)/1e3).toFixed(t)+"s - "+e[r].note:"0.0000s - "+e[r].note);var s=e[e.length-1].time-e[0].time,i={logs:e,total:(s/1e3).toFixed(t),diff:n,text:"Done in "+(s/1e3).toFixed(t)+" seconds."};return i}},deepcopy:function(e){return JSON.parse(JSON.stringify(e))},deepextend:function(){var e,t,r,s,i,o,a=function(e){if(!e||!this.object||e.nodeType)return!1;try{if(e.constructor&&!hasOwn.call(e,"constructor")&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}var n;for(n in e);return void 0===n||hasOwn.call(e,n)},u=arguments[0]||{},l=1,c=arguments.length,h=!1;for("boolean"==typeof u&&(h=u,u=arguments[1]||{},l=2),"object"==typeof u||_.isFunction(u)||(u={}),l=0;c>l;l++)if(null!=(e=arguments[l]))for(t in e)r=u[t],s=e[t],u!==s&&(h&&s&&(a(s)||(i=_.isArray(s)))?(i?(i=!1,o=r&&_.isArray(r)?r:[]):o=r&&a(r)?r:{},u[t]=n.deepextend(h,o,s)):void 0!==s&&(u[t]=s));return u},format:{date:function(t){return log("Warning: util.format.date() is deprecated (at this location), has to live somewhere else."),e(t).format("DD.MM.YYYY - HH:mm:ss")},number:function(e,n){return log("Warning: util.format.number() is deprecated (at this location), has to live somewhere else."),n=n="de_DE",t.language(n,{delimiters:{thousands:".",decimal:","},currency:{symbol:"â‚¬"}}),t(e).format("0,0")}},isBusy:function(e){return log("Warning: util.isBusy() is deprecated, now handled by Handler.Form"),e=$(e),e.addClass("frog-busy"),!0},isIdle:function(e){return log("Warning: util.isIdle() is deprecated, now handled by Handler.Form"),e=$(e),e.hasClass("frog-busy")?(e.removeClass("frog-busy"),!0):!1},log:{mongo:{down:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [mongodb] no connection, service down",console.log(t)},error:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [mongodb] error occured",console.log(t)},exit:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [mongodb] service exited",console.log(t)},up:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [mongodb] connection established",t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [mongodb] service up, runs on http://"+this.host+":"+this.port,console.log(t)}},node:{process:function(t,n){var r="";r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] Process (PID): "+t.pid,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] Node.js: "+t.versions.node,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] Running on port "+n+", debug on port "+t.debugPort,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] Visit at http://localhost:"+n,console.log(r)},exception:function(t,n,r){var s="";s+="\n",s+=r?e().format("D MMM HH:mm:ss")+" - [node] "+t.toUpperCase()+": "+n.stack:e().format("D MMM HH:mm:ss")+" - [node] "+t.toUpperCase()+": "+n,console.log(s)},uncaughtException:function(t,n,r,s){var i="";i+="\n",i+=e().format("D MMM HH:mm:ss")+" - [node] "+status,i+="\n",i+=e().format("D MMM HH:mm:ss")+" - [node] "+t.method+" "+t.url,i+="\n",i+=e().format("D MMM HH:mm:ss")+" - [node] REFERER "+t.headers.referer,i+="\n",i+=e().format("D MMM HH:mm:ss")+" - [node] USER-AGENT "+t.headers["user-agent"],i+="\n",i+=e().format("D MMM HH:mm:ss")+" - [node] "+s.stack,console.log(i)},req:{error:function(t,n){var r="";r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] "+n,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] "+t.method+" "+t.url,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] REFERER "+t.headers.referer,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] USER-AGENT "+t.headers["user-agent"],console.log(r)},success:function(t,n){var r="";r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] "+n,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] "+t.method+" "+t.url,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] REFERER "+t.headers.referer,r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] USER-AGENT "+t.headers["user-agent"],console.log(r)}},up:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [node] server started",t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [node] service up, runs on http://localhost:"+this.$.port,console.log(t)},workers:{up:function(){var t="";t+="\n",t+=e().format("D MMM HH:mm:ss")+" - [node] worker up",console.log(t)},down:function(t,n){var r="";r+="\n",r+=e().format("D MMM HH:mm:ss")+" - [node] worker with PID "+n.id+" died, rip, his mother loved him",console.log(r)}}},time:{resources:function(e,t,n){var r=e.get("object");return"undefined"==typeof t[r]&&(t[r]={}),"undefined"==typeof t[r].time&&(t[r].time=[]),t[r].time.push({time:(new Date).getTime(),note:n}),t}}},messages:{"2xx":{"00000":"Request, response, ok.","00001":"X-domain preflight request (OPTIONS), response, ok.","00002":"Web hook request (POST), response, ok."},"4xx":{"00000":"Unknown error.","00001":"Failed to connect to database.","00002":"Document(s) not found.","00003":"Request body not found.","00004":"Request body is missing required keys.","00021":"Request querystring not found.","00022":"Request querystring is missing required keys.","00010":"Resource not found.","00011":"Missing key header.","00012":"","00013":"Missing session header.","00014":"Invalid key header.","00015":"","00016":"HTTP method not allowed.","00017":"Client group not allowed.","00018":"Client key not allowed.","00019":"Client key denied.","00020":"Clients could not be retrieved."}},mouseWheelListener:function(e){log("Warning: util.mouseWheelListener() is deprecated (at this location), has to live somewhere else."),e.preventDefault()},modal:{height:600,cssClass:"frog-modal-default",content:null,outer:null,close:null,mask:null,body:null,afterShow:null,afterHide:null,init:function(e,t){log("Warning: util.modal.init() is deprecated (at this location), has to live somewhere else.");var r=this;t=t||n.noop;for(var s in e)({}).hasOwnProperty.call(e,s)&&(this[s]=e[s]);return $("."+this.cssClass+" .frog-modal-body").html()?(t(this),this):(this.body=$('<div class="frog-modal-body"></div>'),this.close=$('<div class="frog-modal-close">X</div>'),this.mask=$('<div class="frog-modal-mask"></div>'),this.outer=$('<div class="frog-modal">'),$("body").append(this.outer.append(this.body.append(this.content)).append(this.close).append(this.mask).addClass(this.cssClass).css({height:this.height+"px"}).delay(500).queue(function(e){t(r),e()})),this.close.unbind().bind("click",this.hide),this.mask.unbind().bind("click",this.hide),$(document).on("keyup",function(e){e.keyCode===n.KEYCODE_ESC&&r.hide()}),this)},hide:function(e){return log("Warning: util.modal.hide() is deprecated (at this location), has to live somewhere else."),e=e||this.afterHide||n.noop,$("html").removeClass("frog-modal-in").addClass("frog-modal-out"),$(document).off("mousewheel",n.mouseWheelListener),"function"==typeof e&&e(this),this},show:function(e){return log("Warning: util.modal.show() is deprecated (at this location), has to live somewhere else."),e=e||this.afterShow||n.noop,$("html").removeClass("frog-modal-out").addClass("frog-modal-in"),$(document).on("mousewheel",n.mouseWheelListener),"function"==typeof e&&e(this),this},destroy:function(e){return log("Warning: modal.destroy() is deprecated (at this location), has to live somewhere else."),e=e||n.noop,this.outer.detach(),"function"==typeof e&&e(this),this}},noop:function(){return!0},parseCookie:function(e){var t={},n=e.cookie;return n&&n.split(";").forEach(function(e){var n=e.split("=");t[n.shift().trim()]=n.join("=")}),t},timestamp:function(){return(new Date).getTime()},time:function(){return(new Date).toLocaleString()},validate:function(e,t,n){if(!e||_.isEmpty(e))return n("00003");for(var r=0;r<t.length;r++)if("undefined"==typeof e[t[r]])return n("00004");n(null)}};return n}),define("src/xhr",["superagent","./util"],function(e,t){return e.end=function(e){return e=e||t.noop,this.run(function(t){return t.error?e(!0,t.error,t.status,"XHR_ERROR",t):t.body&&t.body.status>=400?e(!0,t.body,t.body.status,t.body.code,t):e(null,t.body,t.body.status,t.body.code,t)})},e.get=function(t,n,r){var s=e("GET",t);return s.run=s.end,s.end=function(){e.end.apply(s,arguments)},"function"==typeof n&&(r=n,n=null),n&&s.query(n),r&&s.end(r),s},e.head=function(t,n,r){var s=e("HEAD",t);return s.run=s.end,s.end=function(){e.end.apply(s,arguments)},"function"==typeof n&&(r=n,n=null),n&&s.send(n),r&&s.end(r),s},e.del=function(t,n){var r=e("DELETE",t);return r.run=r.end,r.end=function(){e.end.apply(r,arguments)},n&&r.end(n),r},e.patch=function(t,n,r){var s=e("PATCH",t);return s.run=s.end,s.end=function(){e.end.apply(s,arguments)},"function"==typeof n&&(r=n,n=null),n&&s.send(n),r&&s.end(r),s},e.post=function(t,n,r){var s=e("POST",t);return s.run=s.end,s.end=function(){e.end.apply(s,arguments)},"function"==typeof n&&(r=n,n=null),n&&s.send(n),r&&s.end(r),s},e.put=function(t,n,r){var s=e("PUT",t);return s.run=s.end,s.end=function(){e.end.apply(s,arguments)},"function"==typeof n&&(r=n,n=null),n&&s.send(n),r&&s.end(r),s},e}),define("src/Base",["./Inherit","./util","underscore","./xhr"],function(e,t,n){return Class.extend({_ctor:function(e){return this.$={},e&&n.extend(this.$,e),this},get:function(e){if(e=e||null,!e)return this.$;if(e){for(var n=e.split("."),r=t.deepextend(!0,{},this.$),s=0;s<n.length;s++){if(!r.hasOwnProperty(n[s]))return void 0;r=r[n[s]]}return r}return e?void 0:this.$},set:function(e,t){if(e=e||null,t=t||null,!e&&!t)return!1;if(n.isArray(e)){for(var r=0;r<e.length;r++)this.set(e[r]);return this}if(n.isObject(e)){for(var r in e)this.set(r,e[r]);return this}if(n.isString(e)){for(var s,i=!1,o=this.$,a=e.split("."),r=0;r<a.length;r++)s=a[r],r<a.length-1?(o[s]||(i=!0),o[s]=o[s]||{}):o[s]=t,o=o[s];return this}},noop:function(){return log("Warning: Base.noop() is deprecated, consider using frog.util.noop()"),logTrace(),!0}})}),define("src/Flow",["./Inherit","./util","underscore"],function(e,t,n){var r=Class.extend({_ctor:function(e){return this.$={last:null,idle:!0,jobs:[],vars:{},done:null,dead:!1,name:null},e&&n.extend(this.$,e),this},_setFlow:function(e,t){switch(arguments.length){case 0:return this;case 1:e=e||null,t=!1;break;default:e=e||null,t=t||!1}t?("par"===this.$.last?this.$.jobs[this.$.jobs.length-1].push(e):this.$.jobs.push([e]),this._setLast("par")):(this.$.jobs.push(e),this._setLast("seq"))},_setLast:function(e){return e=e||"seq",this.$.last=e,this},_next:function(e){var t=this,r=function(e,n){if(e.shift(),e.length>0){if(!t.$.dead)return t._next(e);if(n)return n();t.$.done.call(t,null,t.$.data)}else{if(n)return n();t.$.done.call(t,null,t.$.data)}},s=function(e,n){if(n=n||null,e[0].callback.length)e[0].callback.call(t,function(s,i){return"__die__"===e[0].name?r(e,n):(e[0].name&&t.set(e[0].name,i||null),void r(e,n))});else{var s=e[0].callback.call(t);if("__die__"===e[0].name)return r(e,n);e[0].name&&t.set(e[0].name,s||null),r(e,n)}};if(this.$.dead)return this.$.done.call(this,null,this.$.data);if(n.isArray(e[0]))if(e[0].length>0)for(var i=e[0].length,o=0,a=0;i>a;a++)s([e[0][a]],function(){return o+=1,o>=i?(e.shift(),t._next(e)):void 0});else e.length>0?s(e):this.$.done.call(this,null,this.$.data);else e.length>0?s(e):this.$.done.call(this,null,this.$.data)},die:function(e,t){var r=this;if(this.$.idle)return this.$.jobs.push({name:"__die__",callback:function(){return r.die.call(r,e)}}),this;if(e||e===!1)if(n.isFunction(e))this.$.dead=!0,this.$.done=e;else if(e===!0)this.$.dead=!0,n.isFunction(t)&&(t.length?t(!1):this.$.done=t);else{if(!n.isFunction(t))return t||!1;t.length?t(!0):this.$.done=t}else this.$.dead=!0},end:function(e){e=e||t.noop,this.$.idle=!1,this.$.done=e,this._next(this.$.jobs)},get:function(e){return e=e||null,e?this.$.vars[e]:this.$.vars},par:function(e,n){switch(arguments.length){case 0:return this;case 1:n=e,e=null;break;default:n=n||t.noop,e=e||null}return this._setFlow({name:e,callback:n},"par"),this},parEach:function(e){for(var t=this,n=0;n<e.length;n++)!function(e,n){t.par(e[n])}(e,n);return this},seq:function(e,n){switch(arguments.length){case 0:return this;case 1:n=e,e=null;break;default:n=n||t.noop,e=e||null}return this._setFlow({name:e,callback:n}),this},seqEach:function(e){for(var t=this,n=0;n<e.length;n++)!function(e,n){t.seq(e[n])}(e,n);return this},set:function(e,t){return e=e||null,t=t||null,e?(this.$.vars[e]=t,this):this}}),s=function(e){return new r(e)},i=function(e,n){switch(arguments.length){case 0:return new r;case 1:n=e,e=null;break;default:n=n||t.noop,e=e||null}var s=new r;return s.par.call(s,e,n),s},o=function(e){var t=new r;return t.parEach.call(t,e),t},a=function(e,n){switch(arguments.length){case 0:return new r;case 1:n=e,e=null;break;default:n=n||t.noop,e=e||null}var s=new r;return s.seq.call(s,e,n),s},u=function(e){var t=new r;return t.seqEach.call(t,e),t};return{init:s,par:i,parEach:o,seq:a,seqEach:u}}),define("src/Api",["./Base","./Flow","./util","./xhr"],function(e,t,n,r){return e.extend({_ctor:function(e){return this.$={context:null,endpoint:"/api",headers:{"Content-Type":"application/json"},host:null,port:null,protocol:"https"},e&&_.extend(this.$,e),this},_setUrl:function(e){if("http"===e.substr(0,4))return e;var t="";return this.$.protocol&&(t+=this.$.protocol+"://"),this.$.host&&(t+=this.$.host),this.$.port&&(t+=":"+this.$.port),this.$.endpoint&&(t+=this.$.endpoint),this.$.context&&(t+=this.$.context),t+=e},del:function(){arguments[0]=this._setUrl(arguments[0]);var e=r.del.apply(r,arguments);return this.$.headers&&e.set(this.$.headers),e},get:function(){arguments[0]=this._setUrl(arguments[0]);var e=r.get.apply(r,arguments);return this.$.headers&&e.set(this.$.headers),e},post:function(){arguments[0]=this._setUrl(arguments[0]);var e=r.post.apply(r,arguments);return this.$.headers&&e.set(this.$.headers),e},put:function(){arguments[0]=this._setUrl(arguments[0]);var e=r.put.apply(r,arguments);return this.$.headers&&e.set(this.$.headers),e}})}),define("src/Collection",["./Base","./util"],function(e,t){return e.extend({_ctor:function(e){return this.$={api:null,data:[],dataScope:[],endpoint:"/",index:"_id",Model:[],model:null,offset:0,limit:100,scope:null,scopes:{}},e&&_.extend(this.$,e),this},getById:function(e){for(var t=(this.$.index,this.$.data||[]),n=0;n<t.length;n++)if(t[key]===e)return t[key];return null},getByProperty:function(e,t){for(var n=this.$.data||[],r=[],s=0;s<n.length;s++)n[e]===t&&r.push(n[e]);return 0===r.length?null:r},setById:function(e,t){for(var n=(this.$.index,this.$.data||[]),r=0;r<n.length;r++)if(n[key]===e)return _.extend(n[key],t),n[key];return null},index:function(e,n){switch(arguments.length){case 0:e=null,n=t.noop;break;case 1:_.isFunction(e)?(n=e,e=null):(n=t.noop,e=e||{});break;default:e=e||{},n=n||t.noop}var r=this,s=this.$.api,i=this.$.url,o=e&&"undefined"!=typeof e.limit?e.limit:r.get("limit"),a=e&&"undefined"!=typeof e.offset?e.offset:r.get("offset");s.get(i).query({limit:o,offset:a}).end(function(e,t,s){if(e||t.error)return console.log("o(O",e,t,s),n(!0);var i=r.$.data||[],u=0;i.length<a&&(u=a-i.length,a-=u);for(var l=a+u,c=l+o,h=0,d=0;c>d;d++)l>d?i[d]=i[d]||null:(i[d]=t.data[h]||null,h++);r.$.data=i,n(null,i)})},update:function(e,n){switch(arguments.length){case 0:e=null,n=t.noop;break;case 1:_.isFunction(e)?(n=e,e=null):(n=t.noop,e=e||{});break;default:e=e||{},n=n||t.noop}var r=e.id,s=e.data||{},i=this.setById(r,s);if(!i)return n(!0,null,404);if("undefined"!=typeof e.save&&e.save===!1)return n(null,i,204);var o=this.$.api,a=this.$.url+"/"+r;o.put(a).send(i).end(function(e,t,r){return e||t.error?(console.log("o(O",e,t,r),n(!0)):void n(null,i,204)})},data:function(e){return e=e||null,e?this.set("data",e):this.get("data")},filter:function(e,t){var n=this.get("scopes");return n[e]=t,this.set("scopes",n),this},scope:function(e){e=e||this.get("scope")||null;var t=this.get("data");if(!e)return t;var n=this.get("scopes."+e);if("undefined"==typeof n)return[];var r=n(t);return this.set("dataScope",r),r}})}),define("src/singleton",[],function(){var e={app:null,api:null,clients:null,components:{},config:null,resources:null,server:null,text:{}};return e}),define("src/date",["moment"],function(e){var t={formats:{utc:"MM-DD-YYYY HH:mm:ss.sss ZZ",iso:"YYYY-MM-DDTHH:mm:ss.sss",tpl:{de:"DD.MM.YYYY - HH:mm:ss",de_day:"DD.MM.YYYY"}},getUTC:function(){var n=e.utc().format(t.formats.utc);return n},getUTCLocal:function(){var n=e().local().format(t.formats.utc);return n},as:function(n,r,s){s=s||t.formats.utc;var n=e(n,r).format(s);return n},is:function(n,r){switch(arguments.length){case 0:return null;case 1:n=n||null,r=t.formats.tpl.de;break;default:n=n||null,r=t.formats.tpl[r]||r}var n=e(n,t.formats.utc).format(r);return n}};return t}),define("src/View",["./Base","./date","./Flow","./util","ejs"],function(e,t,n,r,s){return e.extend({_ctor:function(e){return this.$={api:null,compiled:null,data:{date:t,util:r},markup:null,mode:"html",file:null,rendered:null,selector:"body"},e&&_.extend(this.$,e),this},_compile:function(){return this.$.compiled=s.compile(this.$.markup),this},_load:function(e){var t=this,n=this.$.file.split(".");n[n.length-1]!==this.$.mode&&(this.$.file=n+"."+this.$.mode);var r="text!"+this.$.file;try{if(this.$.markup=$("#html-"+this.$.file).html(),this.$.markup){if(e)return e.call(this,this.$.markup);return}this.$.markup=require(r),e.call(this,this.$.markup)}catch(s){require([r],function(n){return t.$.markup=n,e?e.call(t,t.$.markup):void 0})}},_render:function(){switch(this.$.rendered=this.$.compiled(this.$.data),this.$.mode){case"replaceAll":$(this.$.rendered).replaceAll(this.$.selector);break;default:$(this.$.selector)[this.$.mode](this.$.rendered)}return this},data:function(e){if(e=e||null,!e||!_.isObject(e))return this;var t=this.get("data");return _.extend(t,e),this.set("data",t),this},render:function(e,t){var s=this;switch(arguments.length){case 1:_.isFunction(e)?(t=e,e={}):(t=r.noop,e=e||{});break;default:e=e||{},t=t||r.noop}this.data(e),n.seq(function(e){return s.$.markup?e():void s._load(function(){e()})}).seq(function(e){return s.$.compiled?e():(s._compile(),void e())}).seq(function(){return s._render(),t?t.call(s,s.$.rendered):void 0}).end()}})}),define("src/Component",["./Api","./Base","./singleton","./Flow","./util","./View"],function(e,t,n,r,s,i){var o=t.extend({_ctor:function(e){return this.$={data:{debug:!1,dependencies:[],version:null},config:null,el:null,meta:null,id:null,file:null,selector:null,layout:"layout",view:null},e&&_.extend(this.$,e),this._getComponent(),this._getData(),this._getFile(),this._cache(),this},_getComponent:function(){return this.$.selector="[data-component="+this.$.id+"]",this.$.el=$(this.$.selector),this},_getData:function(){return this.$.data=this.$.el.data(),this},_getFile:function(){var e="";return e+="frog",e+="/components/",e+=this.$.id,e+="/html",e+="/"+this.$.layout,this.$.file=e,this},_getModules:function(e,t){t=t||s.noop;for(var n=[],r={},i=0;i<e.length;i++)n[i]=e[i].module,r[e[i].name]=e[i].module;return t(null,r,n)},_cache:function(){return n.components[this.$.id]=this,this},_render:function(e){e=e||s.noop;var t=this,n=new i({file:this.$.file,globals:{component:this},selector:this.$.selector});this.$.view=n,n.render(function(){e.apply(t,arguments)})},_trigger:function(){var e=this.$.config,t="";t+=e.components.paths.base+"/"+this.$.id,t+="/"+e.components.paths.root,define("frog/components/"+this.$.id,n.components[this.$.id]);try{require(t)}catch(r){require([t])}},bootstrap:function(e,t){t=t||s.noop;var i=this;n.config=this.$.config=e;var a=this.$.data;r.seq(function(t){if("undefined"==typeof a||"undefined"==typeof a.dependencies||!_.isString(a.dependencies))return t();for(var n=a.dependencies.split(","),r=n.length,s=0,i=0;i<n.length;i++)new o({id:n[i]}).bootstrap(e,function(){return s+=1,s>=r?t():void 0})}).seq(function(){i._render(function(){i._trigger(),t.call(i,null,i)})}).end()},id:function(e){return e=e||null,e?(this.$.id=id,this):this.$.id},require:function(e,t){t=t||s.noop;for(var n=this,r=e.length,i=0,o=[],a=[],u=0;u<e.length;u++)a[u]=e[u],function(e,s){var u="";u+="frog/components",u+="/"+n.$.id,u+="/"+e[s],require([u],function(e){var u=a[s].split("/");o[s]={name:u[u.length-1],module:e},i+=1,i>=r&&n._getModules(o,t)})}(e,u)}});return o}),define("src/Email",["underscore","./Base","./Flow","./util"],function(e,t,n,r){return t.extend({_ctor:function(t){return this.$={dir:null,i18n:null,password:null,protocol:"SMTP",sender:{email:null,name:null,service:"Gmail",user:null,password:null},state:"idle",template:null,templates:null},t&&e.extend(this.$,t),this._setDir(),this._setTransport(),this},_setData:function(t){return e.extend(t,{i18n:this.$.i18n})},_setDir:function(e){var t=this;e=e||r.noop,templates(this.$.dir,function(n,r){return n?e(!0,null,400,"ERROR_EMAIL_TEMPLATES_COULD_NOT_BE_LOADED"):(t.$.templates=r,t.$.state="ok",void e(null,null,200))})},_setTransport:function(){return this.$.transport=nodemailer.createTransport({auth:{user:this.$.sender.user,pass:this.$.sender.password},service:this.$.sender.service}),this},send:function(e,t){t=t||r.noop;var s=this;n.seq(function(e){return"ok"===s.$.state?e():void s._setDir(e)}).seq(function(n){var r=this,i=s._setData(e.data);s.$.templates(e.template,i,function(e,s,i){return e?t(!0,null,400,"ERROR_EMAIL_NOT_RENDERED"):(r.set("html",s),r.set("text",i),void n())})}).seq(function(){var n=this,r={from:s.$.sender.name+" <"+s.$.sender.email+">",to:"<"+e.email+">",subject:e.subject,html:n.get("html")};s.$.transport.sendMail(r,function(e,n){return e?t(!0,null,400,"ERROR_EMAIL_NOT_SENT"):void t(null,n,200)})}).end()}})}),define("src/Events",["./Base"],function(e){return e.extend({_ctor:function(e){return this.$={events:{},maxListeners:10},e&&_.extend(this.$,e),this},_normalizeType:function(e){var t,n,r;switch(e.length){case 3:t=e[0],n=e[1],r=e[2],n=t.get&&null!==t.id()?t.id()+":"+n:"_global:"+n;break;default:n="_global:"+e[0],r=e[1]}return{type:n,listener:r}},setMaxListeners:function(e){return e=e||null,e&&!_.isNumeric(e)?(this.error.logger({type:"warning","class":"Events",method:".setMaxListeners()",msg:"param `num` of wrong type, must be numeric",data:arguments,file:"Events.js"}),!1):(e&&(e=parseInt(e),this.$.maxListeners=e),e?this:this.$.maxListeners)},emit:function(){var e,t,n,r,s=[];for(e=0;e<arguments.length;e++)switch(e){case 0:_.isString(arguments[e])?(r=arguments[e],n=null):(r=r||null,n=arguments[e]);break;case 1:_.isString(arguments[e])?r=arguments[e]:(r=r||null,s.push(arguments[e]));break;default:s.push(arguments[e])}if(r&&_.isArray(r)){for(e=0;e<r.length;e++)t=n?[n,r[e]]:[r[e]],t.concat(s),this.emit.apply(this,t);return this}if(!r||!_.isString(r))return this.error.logger({type:"warning","class":"Events",method:".emit()",msg:"param `type` of wrong type, must be string",data:r,file:"Events.js"}),!1;r=n&&n.get&&null!==n.id()?n.id()+":"+r:"_global:"+r;var i,o;if(this.$.events=this.$.events||{},i=this.$.events[r]||null,!i)return!1;if(i&&!_.isFunction(i)&&!_.isArray(i))return this.error.logger({type:"warning","class":"Events",method:".emit()",msg:"`handler` of wrong type, must be function or array of functions",data:i,file:"Events.js"}),!1;var a;if(_.isFunction(i))return 0===s.length?i.call(this):i.apply(this,s),!0;if(_.isArray(i)){for(o=i.slice(),e=0,a=o.length;a>e;e++)o[e].apply(this,s);return!0}},addListener:function(e,t){if(e=e||null,t=t||null,_.isFunction(t)||_.isArray(t)){var n;if(_.isArray(e)){for(n=0;n<e.length;n++)this.addListener(e[n],t);return this}if(_.isArray(t)){for(n=0;n<t.length;n++)this.addListener(e,t[n]);return this}if(this.$.events.newListener&&this.emit("newListener",e,_.isFunction(t.listener)?t.listener:t),this.$.events[e]?_.isArray(this.$.events[e])?this.$.events[e].push(t):this.$.events[e]=[this.$.events[e],t]:this.$.events[e]=t,_.isArray(this.$.events[e])&&!this.$.events[e].warned){var r;r=this.$.maxListeners,r&&r>0&&this.$.events[e].length>r&&(this.$.events[e].warned=!0,this.error.logger({type:"warning","class":"Events",method:".addListener()",msg:"LEAK! Too many listeners!",data:arguments,file:"Events.js"}))}return this}},addListenerOnce:function(e,t){function n(){s.removeListener(e,n),t.apply(this,arguments)}if(e=e||null,t=t||null,!_.isFunction(t)&&!_.isArray(t))return this.error.logger({type:"warning","class":"Events",method:".addListenerOnce()",msg:"`listener` of wrong type, must be function or array of functions",data:arguments,file:"Events.js"}),!1;var r,s=this;if(_.isArray(e)){for(r=0;r<e.length;r++)this.addListenerOnce(e[r],t);return this}if(_.isArray(t)){for(r=0;r<t.length;r++)this.addListenerOnce(e,t[r]);return this}return n.listener=t,s.on(e,n),this},removeListener:function(e,t){if(e=e||null,t=t||null,e&&!t)return this.removeAllListeners(e),!1;if(t&&!_.isFunction(t))return this.error.logger({type:"warning","class":"Events",method:".removeListener()",msg:"`listener` of wrong type, must be function",data:arguments,file:"Events.js"}),!1;if(!this.$.events||!this.$.events[e])return this;var n,r;if(n=this.$.events[e],_.isArray(n)){r=-1;for(var s=0,i=n.length;i>s;s++)if(n[s]===t||n[s].listener&&n[s].listener===t){r=s;break}if(0>r)return this;n.splice(r,1),0==n.length&&delete this.$.events[e],this.$.events.removeListener&&this.emit("removeListener",e,t)}else(n===t||n.listener&&n.listener===t)&&(delete this.$.events[e],this.$.events.removeListener&&this.emit("removeListener",e,t));return this},removeAllListeners:function(e){if(!this.$.events)return this;if(!this.$.events.removeListener)return 0===arguments.length?this.$.events={}:e&&this.$.events&&this.$.events[e]&&(this.$.events[e]=null),this;if(0===arguments.length){for(var t in this.$.events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this.$.events={},this}var n;if(n=this.$.events[e],_.isArray(n))for(;n.length;)this.removeListener(e,n[n.length-1]);else n&&this.removeListener(e,n);return this.$.events[e]=null,this},listeners:function(e){return e=e||null,!e||_.isString(e)?e?this.$.events[e]?_.isArray(this.$.events[e])?this.$.events[e].slice(0):[this.$.events[e]]:[]:e?void 0:this.$.events:void 0},on:function(){var e;return e=this._normalizeType(arguments),this.addListener(e.type,e.listener),this},once:function(){var e;return e=this._normalizeType(arguments),this.addListenerOnce(e.type,e.listener),this},off:function(){var e;return e=this._normalizeType(arguments),this.removeListener(e.type,e.listener),this},offAll:function(){var e;return e=this._normalizeType(arguments),this.removeAllListeners(e.type,e.listener),this}})}),define("src/Events.Singleton",["./Events"],function(e){return new e}),define("src/Facebook",["./Base","./Flow","./util","./xhr"],function(e,t,n){return e.extend({_ctor:function(e){return this.$={appId:null,cookie:!1,endpoint:null,frictionlessRequests:!1,friends:[],friendsInvitable:[],hideFlashCallback:null,locale:"de_DE",login:null,permissions:[],permissionsSet:[],sdk:"//connect.facebook.net/[1]/sdk.js",status:!1,user:null,version:"v2.0",xfbml:!1},e&&_.extend(this.$,e),this._setEndpoint(),this},_setEndpoint:function(){return this.$.endpoint=this.$.sdk.replace("[1]",this.$.locale),this},_getFriends:function(e){e=e||n.noop},_getFriendsInvitable:function(e){var r=this;e=e||n.noop,t.seq(function(t){r._getStatus(function(n,r,s,i){return n?e(n,r,s,i):void t()})}).seq(function(){FB.api("/me/invitable_friends",function(t){return log(t),t&&!t.error?e(!0,t.error,400,"facebook_api_error"):(r.$.friendsInvitable=t.data,void e(null,r.$.friendsInvitable,200))})}).end()},_getFriendsKnown:function(e){var t=this;e=e||n.noop,FB.api("/me/friends",function(n){return log(n),n&&!n.error?e(!0,n.error,400,"facebook_api_error"):(t.$.friends=n.data||[],void e(null,t.$.friends,200))})},_getPermissions:function(e){var r=this;e=e||n.noop,t.seq(function(t){r._getLoginStatus(function(n,r,s,i){return n?e(n,r,s,i):void t()})}).seq(function(){FB.api("/me/permissions",function(t){return t&&!t.error?e(!0,t.error,400,"facebook_api_error"):(r.$.permissionsSet=t.data,void e(null,r.$.permissionsSet,200))})}).end()},_getSdk:function(e){var t=this;e=e||n.noop,window.fbAsyncInit=function(){FB.init({appId:t.$.appId,cookie:t.$.cookie,frictionlessRequests:t.$.frictionlessRequests,hideFlashCallback:t.$.hideFlashCallback,status:t.$.status,version:t.$.version,xfbml:t.$.xfbml}),e()},function(e,n,r){var s,i=e.getElementsByTagName(n)[0];e.getElementById(r)||(s=e.createElement(n),s.id=r,s.src="//connect.facebook.net/"+t.$.locale+"/sdk.js",i.parentNode.insertBefore(s,i))}(document,"script","facebook-jssdk")},_getStatus:function(e){var r=this;e=e||n.noop,t.seq(function(e){FB.getLoginStatus(function(t){r.set("login",t),e()})}).seq(function(){switch(r.$.login.status){case"connected":return r.$.user={},e(null,200,r.$.login);case"not_authorized":return e(!0,401,r.$.login);default:return e(!0,401,r.$.login)}}).end()},_getUser:function(e){var t=this;FB.api("/me",function(n){return n&&n.error?e(!0,n,400,"BAD_REQUEST"):(t.$.user=_.extend(t.$.user,n),void e(null,t.$.user,200))})},_getUserImage:function(e){var t=this;FB.api("/me/picture",{height:"200",redirect:"false",type:"normal",width:"200"},function(n){return n&&n.error?e(!0,n,400,"BAD_REQUEST"):(t.$.user=_.extend(t.$.user,{picture:n.data}),void e(null,t.$.user,200))})},friends:function(e,t){var r=this;switch(arguments.length){case 1:_.isFunction(e)?(t=e,e=null):(e=e||null,t=n.noop);break;default:e=e||null,t=t||n.noop}switch(e){case"invitable":r._getFriendsInvitable(t);break;case"known":r._getFriendsKnown(t);break;default:r._getFriends(t)}},init:function(e){var r=this;e=e||n.noop,t.seq(function(e){r._getSdk(e)}).seq(function(e){r._getStatus(e)}).par(function(e){r._getUser(e)}).par(function(e){r._getUserImage(e)}).end(function(){r.$.ready=!0,e(null,r.$.user,200)})},invite:function(e,r){var s=this;r=r||n.noop,t.seq(function(e){s._getPermissions(function(t,n,s,i){if(t)return r(t,n,s,i);var o=_.find(n,function(e){"user_friends"===e.permission});return o?void e():r(!0,null,401,"missing_permissin")})}).seq(function(e){s._getFriendsInvite(function(t,n,s,i){return t?r(t,n,s,i):void e()})}).seq(function(t){for(var n=this,i=[],o=0;o<s.$.friendsInvitable.length;o++)i.push(s.$.friendsInvitable[o].id);i=i.join(","),FB.ui({method:"apprequests",message:e,to:i},function(e){return e&&!e.error?r(!0,e.error,400,"facebook_api_error"):(trc(e.data),n.set("invites",e.data),void t())
})}).seq(function(){r(null,null,200)}).end()},login:function(e){var t=this;e=e||n.noop,frog.Flow.seq(function(n){var r=t.$.permissions||[];FB.login(function(r){return"connected"===r.status?(t.$.user=r.authResponse,n()):(t.$.login=r,e(!0))},{scope:r.join(",")})}).par(function(e){t._getUser(e)}).par(function(e){t._getUserImage(e)}).end(function(){e(null,t.$.user,200)})},ready:function(){return this.$.ready||!1}})}),define("src/validations",["./util"],function(e){var t={ifRange:function(e,n,r){var s=!1;e&&""!==e&&(s=t.isRange(e,n,r))},isChecked:function(e,t,n){var r=!1;return r=$("[name="+t[1]+"]").is(":checked"),n(!r)},isCreditCard:function(e,t,n){var r=!1;if(/[^0-9 \-]+/.test(e))return n(!0);var s,i,o=0,a=0,u=!1;if(e=e.replace(/\D/g,""),e.length<13||e.length>19)return!1;for(s=e.length-1;s>=0;s--)i=e.charAt(s),a=parseInt(i,10),u&&(a*=2)>9&&(a-=9),o+=a,u=!u;return r=o%10===0,n(!r)},isEmail:function(e,t,n){var r=!1,s=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return r=s.test(e),n(!r)},isEmails:function(e,t,n){var r=!1;return n(!r)},isEnum:function(e,t,n){var r=!1;return t.splice(0,1),t.indexOf(e)>-1&&(r=!0),n(!r)},isEqualTo:function(e,t,n){var r=!1;return r=e===t[1],n(!r)},isEqualToField:function(e,t,n){var r=!1,s=$("[name="+t[1]+"]",this.$.el).val();return r=s===e,n(!r)},isInList:function(e,t,n){var r,s=!1,i=$("[name="+t[1]+"]",this.$.el);return $("option",i).each(function(){r=$(this).val(),""!==r&&r===e&&(s=!0)}),n(!s)},isMax:function(e,t,n){var r=!1;return e=parseInt(e),r=e<=t[1],n(!r)},isMaxLength:function(e,t,n){var r=!1;return r=e.length<=t[1],n(!r)},isMin:function(e,t,n){var r=!1;return e=parseInt(e),r=e>=t[1],n(!r)},isMinLength:function(e,t,n){var r=!1;return r=e.length>=t[1],n(!r)},isNoop:function(e,t,n){var r=!0;return n(!r)},isRange:function(e,t,n){var r=!1;return e=parseInt(e),r=e>=parseInt(t[1])&&e<=parseInt(t[2]),n(!r)},isRangeLength:function(e,t,n){var r=!1;return r=e.length>=t[1]&&e.length<=t[2],n(!r)},isNumbersOnly:function(e,t,n){var r=!1;return r=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e),n(!r)},isOptional:function(t,n,r){var s=!1;return"undefined"==typeof t||null===t||""===t?r():(s=e.trim(t).length>=1,r(!s))},isRequired:function(t,n,r){var s=!1;return t&&(s=e.trim(t).length>0),r(!s)}};return t}),define("src/Handler.Form",["./Base","./date","./Flow","./util","./validations"],function(e,t,n,r,s){return e.extend({_ctor:function(e){return this.$={action:!0,css:{field:"field",fieldError:"field-error",fieldErrorMessage:"field-error-message",fieldErrorFlag:"field-error-flag",fieldSuccess:"field-success",fieldSuccessFlag:"field-success-flag",form:"form",formBusy:"form-busy",formCancel:"form-cancel",formError:"form-error",formErrorMessage:"form-error-message",formNative:"form-native",formSubmit:"form-submit"},data:{},el:null,endpoint:"/",errors:null,errors_all:!1,fields:{},globals:{date:t,util:r},listeners_fields:!1,listeners_forms:!1,markup:{error_field:"",error_form:""},method:"POST",namespace:null,prefix:"frog-",rules:{},selector:"form",state:"loaded",text:{},valid:!0,validations:s,view:null},e&&_.extend(this.$,e),this._setPrefix(),this},_busy:function(e){e=e||null;var t=this.$.selector+" ",n=this.$.css;return e?(this.$.state="busy",$(t).addClass(n.formBusy)):(this.$.state="idle",$(t).removeClass(n.formBusy)),this},_getForm:function(){return this.$.el=$(this.$.selector),this.$.el.prepend(this.$.markup.error_form),this.$.el},_getFields:function(){var e=this;this.$.fields={};var t=this.$.selector+" ",n=this.$.css;return $(t+"."+n.field+" [name]").each(function(){var r=$(this),s=r.attr("name"),i=r.attr("type")?r.attr("type"):null;s&&""!==s&&(e.$.fields[s]={el:r,name:s,valid:null,tag:r.prop("tagName").toLowerCase(),type:i,value:null},"checkbox"!==i&&"radio"!==i&&r.closest(t+"."+n.field).append(e.$.markup.error_field))}),this.$.fields},_getResults:function(){return{body:this.$.data,fields:this.$.fields,errors:this.$.errors,valid:this.$.valid}},_setPrefix:function(){for(var e in this.$.css)this.$.css[e]=this.$.prefix+this.$.css[e];return this},_setErrorMessage:function(e){for(var t,n,r,s=this.$.rules[e]||[],i=this.$.errors[e],o="",a=[],u=0;u<i.length;u++){if(n=i[u],r=this.$.text[n],t=_.isArray(s[1])?s[1]:null)for(var u=1;u<t.length;u++)r=r.replace("["+u+"]",t[u]);""!==o&&(o+="</br>"),o+=r,a.push(r)}return this.$.errors_all?o:a[a.length-1]},_setFieldListeners:function(){var e=this,t=(this._getForm(),this._getFields()),n=this.$.selector+" ",r=(this.$.css,this.$.text,function(t){e.validate(t)}),s=function(e,t,s){switch(t){case"select":$(document).on("change",n+"[name="+e+"]",function(){r(e)});break;default:switch(s){case"checkbox":$(document).on("click",n+"[name="+e+"]",function(){r(e)});break;case"hidden":$(document).on("change",n+"[name="+e+"]",function(){r(e)});break;case"range":$(document).on("input",n+"[name="+e+"]",function(){r(e)});break;default:$(document).on("blur",n+"[name="+e+"]",function(t){t.preventDefault(),r(e)})}}};for(var i in t)s(i,t[i].tag,t[i].type);return this},_setFormListener:function(){var e=this,t=this.$.selector+" ",n=this.$.css;$(document).on("click",t+"."+n.formCancel+" a",function(t){t.preventDefault(),e.done()}),$(document).on("click",t+"."+n.formSubmit+" a",function(e){e.preventDefault(),$(this).submit()}),$(document).on("submit",t,function(t){var r=$(this);r.hasClass(n.formNative)?r.removeClass(n.formNative):(t.preventDefault(),e._submit())})},_setMarkup:function(){{var e=this.$.css;this.$.prefix}return _.extend(this.$.markup,{error_field:'<div class="'+e.fieldErrorMessage+'"></div><div class="'+e.fieldErrorFlag+'">'+this.$.text.defaultError+'</div><div class="'+e.fieldSuccessFlag+'">'+this.$.text.defaultSuccess+"</div>",error_form:'<div class="'+e.formErrorMessage+'">'+this.$.text.formError+"</div>"}),this},_setStateClasses:function(e){var t=(this.$.text,this.$.selector+" "),n=this.$.css,r=$(t+"[name="+e+"]"),s=r.closest("."+n.field),i=r.attr("name"),o=!1;if(this.$.errors&&this.$.errors[e]&&_.isArray(this.$.errors[e])&&this.$.errors[e].length>0&&(o=!0),o){s.addClass(n.fieldError),s.removeClass(n.fieldSuccess);var a=this._setErrorMessage(i);$("."+n.fieldErrorMessage,s).html(a)}else s.removeClass(n.fieldError),s.addClass(n.fieldSuccess),$("."+n.fieldErrorMessage,s).html("");this.$.valid?($("."+n.formErrorMessage,this.$.el).html(""),$(t).removeClass(n.formError)):($("."+n.formErrorMessage,this.$.el).html(this.$.text.form),$(t).addClass(n.formError))},_submit:function(){var e=this,t=this.$.css;return"idle"!==this.$.state?!1:void this.validate(function(n,r){if(e._busy(!0),!r.valid)return e._busy(!1);if(e.$.action===!0){var s=e.$.el;return s.addClass(t.formNative),s.submit()}return e.$.action&&_.isFunction(e.$.action)?e.$.action.call(e,null,r):void 0})},done:function(e){e=e||null;var t=(this.$.selector+" ",this.$.css);if(e){var n=this.$.el.closest(t.field);return n.removeClass(t.fieldError+" "+t.fieldSuccess),this}return this.$.el.removeClass(t.formBusy+" "+t.formError),$("."+t.field,this.$.el).each(function(){$(this).removeClass(t.fieldError+" "+t.fieldSuccess)}),this._busy(!1),this},data:function(e){return(e=e||null)?(_.extend(this.$.globals,{form:this.$}),_.extend(this.$.globals,e),this):this.$.globals},error:function(e,t){e=e||null;var n=this.$.errors||{};"undefined"==typeof n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),_.isEmpty(n)&&(n=null),this.$.errors=n,this.$.valid=!("undefined"!=typeof this.$.errors&&!_.isEmpty(this.$.errors));var r=this._getResults();return this._setStateClasses(e,r),this},fetch:function(e){e=e||null;for(var t={},n=this.$.el.serializeArray(),r=0;r<n.length;r++)t[n[r].name]=n[r].value;return this.$.data=t,t},idle:function(){return this._busy(!1),this},init:function(){var e=this.$.selector+" ",t=this.$.css;return this._setMarkup(),this._setFieldListeners(),this._setFormListener(),this.$.state="idle",$(e+"."+t.formSubmit+" button").removeAttr("disabled"),this},redirect:function(e){return e=e||this.$.redirect||null,e?window.location.href=e:this},render:function(e,t){switch(arguments.length){case 0:e=null,t=r.noop;break;case 1:_.isFunction(e)?(t=e,e=null):(e=e||null,t=r.noop);break;default:t=t||r.noop,e=e||null}var n=this;e&&this.data(e),this.$.view.render(this.$.globals,function(){n.init(),t()})},reset:function(e){e=e||null,this.done();var t;return t=$(e?this.$.selector+" [name="+e+"]":this.$.selector+" [name]"),t.val(""),t.prop("checked",!1),t.prop("selectedIndex",0),this},send:function(e){return this.$.action=e,this},success:function(e){return e=e||null,this},test:function(e,t){if(_.isArray(e)){for(var n=0;n<e.length;n++)this.test(e[n]);return this}if(_.isObject(e)){for(var r in e)this.test(r,e[r]);return this}if(t=t||null,!t)return this;if("undefined"==typeof this.$.rules[e])this.$.rules[e]=t;else for(var n=0;n<t.length;n++)this.$.rules[e].push(t[n]);return this},text:function(e){return e=e||null,e?(_.extend(this.$.text,e),this):this.$.text},validate:function(e,t){switch(arguments.length){case 1:_.isFunction(e)?(t=e,e=null):(e=e||null,t=r.noop);break;default:e=e||null,t=t||r.noop}var n,s=this,i=function(t,n){var r=s.$.errors||{};if(t)"undefined"==typeof r[e]&&(r[e]=[]),-1===r[e].indexOf(f)&&r[e].push(f);else if(null!==r&&"undefined"!=typeof r[e]){var i=r[e].indexOf(f);r[e].splice(i,1),0===r[e].length&&delete r[e]}_.isEmpty(r)&&(r=null),s.$.errors=r,s.$.valid=!("undefined"!=typeof s.$.errors&&!_.isEmpty(s.$.errors)),n()};if(s._busy(!1),!e){var o=[];for(var a in this.$.fields)o.push(this.$.fields[a]);for(var u=0,l=o.length,c=0;c<o.length;c++)this.validate(o[c].name,function(){return u+=1,u>=l?(n=s._getResults(),t(null,n)):void 0});return this}for(var h,d,f,m=this.fetch(e)[e],p=this.$.rules[e]||[],l=p.length,u=0,c=0;c<p.length;c++)h=p[c],_.isArray(h)?(f=h[0],d=_.isFunction(h[1])?h[1]:s.$.validations[f]):_.isFunction(h)?d=h:(f=h,h=[],d=s.$.validations[f]),d.call(s,m,h,function(r){u+=1,i(r,function(){u>=l&&(n=s._getResults(),s._setStateClasses(e,n),t(null,n))})})},validations:function(e){return _.extend(this.$.validations,e),this},exec:function(){return this.validate.apply(this,arguments)}})}),define("src/Handler.Object",["./Base","./date","./Flow","./util","./validations"],function(e,t,n,r,s){return e.extend({_ctor:function(e){return this.$={body:null,errors:null,errors_all:!1,rules:{},valid:!0,validations:s},e&&_.extend(this.$,e),this},_getResults:function(){return{body:this.$.body,errors:this.$.errors,valid:this.$.valid}},data:function(e){return e=e||{},this.set("body",e),this},test:function(e,t){if(_.isArray(e)){for(var n=0;n<e.length;n++)this.test(e[n]);return this}if(_.isObject(e)){for(var n in e)this.test(n,e[n]);return this}if(t=t||null,!t)return this;if("undefined"==typeof this.$.rules[e])this.$.rules[e]=t;else for(var n=0;n<t.length;n++)this.$.rules[e].push(t[n]);return this},validate:function(e,t){switch(arguments.length){case 1:_.isFunction(e)?(t=e,e=null):(e=e||null,t=r.noop);break;default:e=e||null,t=t||r.noop}var n,s=this,i=function(t,n){var r=s.$.errors||{};if(t){"undefined"==typeof r[e]&&(r[e]=[]);for(var i=-1,o=0;o<r[e].length;o++)r[e][o].field===e&&(i=o);-1===i&&r[e].push({field:e,name:d,rule:c,value:s.$.body[e]})}else if(r&&"undefined"!=typeof r[e]){for(var i=-1,o=0;o<r[e].length;o++)r[e][o].field===e&&(i=o);i>-1&&r[e].splice(i,1),0===r[e].length&&delete r[e]}_.isEmpty(r)&&(r=null),s.$.errors=r,s.$.valid=!("undefined"!=typeof s.$.errors&&!_.isEmpty(s.$.errors)),n()};if(!e){var o=[];for(var a in this.$.body)o.push(a);for(var u=0,l=o.length,a=0;a<o.length;a++)this.validate(o[a],function(){return u+=1,u>=l?(n=s._getResults(),n.valid?t(null,n,200,"OK"):t(!0,n,409,"ERROR_VALIDATION")):void 0});return this}for(var c,h,d,f=this.$.body[e],m=this.$.rules[e]||["isNoop"],l=m.length,u=0,a=0;a<m.length;a++)c=m[a],_.isArray(c)?(d=c[0],h=_.isFunction(c[1])?c[1]:s.$.validations[d]):_.isFunction(c)?h=c:(d=c,c=[],h=s.$.validations[d]),h.call(s,f,c,function(e){u+=1,i(e,function(){if(u>=l){if(n=s._getResults(),!n.valid)return t(!0,n,409,"ERROR_VALIDATION");t(null,n,200)}})})},exec:function(){return this.validate.apply(this,arguments)}})}),define("src/I18n",["./Base","./util"],function(e){return e.extend({_ctor:function(e){return this.$={country:null,language:null,locale:null,region:null,text:{}},e&&_.extend(this.$,e),this._setCountry(),this._setLanguage(),this._setRegion(),this._setText(),this},_setCountry:function(){return this.country=this.$.country||null,this},_setLanguage:function(){return this.language=this.$.language||null,this},_setRegion:function(){return this.region=this.$.region||null,this},_setText:function(){return this.text=this.$.text[this.$.language]||{},this},change:function(e){return e&&_.extend(this.$,e),this._setCountry(),this._setLanguage(),this._setRegion(),this._setText(),this},text:{}})}),define("src/log",[],function(){return window.log=function(){this.console&&console.log.apply(this.console,arguments)},window.trc=window.logtrace=function(){this.console&&(console.log.apply(this.console,arguments),console.log(Error().stack.replace("Error","---").replace("at Error (native)","Stack")))},{log:window.log,logtrace:window.logtrace}}),define("src/Model",["./Base"],function(e){return e.extend({_ctor:function(e){return this.$={data:null},e&&_.extend(this.$,e),this},data:function(){return this.get("data")}})}),define("src/require",["./singleton"],function(e){var t=function(e,t){for(var n=[],r={},s=0;s<e.length;s++)n.push(e[s].module),r[e[s].name]=e[s].module;return t?t(null,r,n):void 0},n=function(n,r){for(var s,i=n.length,o=0,a=[],u=[],l=0;l<n.length;l++)!function(n,l){if(u[l]=n[l],"undefined"!=typeof server){var c=e.server;s=c.get("dir")+c.get("server")+"/"+n[l],a[l]={name:u[l],module:require(s)},o+=1,o>=i&&t(a,r)}else require([n[l]],function(e){a[l]={name:u[l],module:e},o+=1,o>=i&&t(a,r)})}(n,l)};return n}),define("src/Route",["./Base"],function(e){return e.extend({_ctor:function(e,t){return t=t||{},this.$={keys:[],params:null,path:e,query:null,regexp:null,uri:null},this.$.options={sensitive:!1,strict:!1},_.extend(this.$.options,t),this},_pathToRegEx:function(e,t,n,r){var s=this;return e instanceof RegExp?e:(e instanceof Array&&(e="("+e.join("|")+")"),e=e.concat(r?"":"/?").replace(/\/\(/g,"(?:/").replace(/(\/)?(\.)?:(\w+)(?:(\(.*?\)))?(\?)?/g,function(e,n,r,i,o,a){return t.push({name:i,optional:!!a}),s.$.keys=t,n=n||"",""+(a?"":n)+"(?:"+(a?n:"")+(r||"")+(o||r&&"([^/.]+?)"||"([^/]+?)")+")"+(a||"")}).replace(/([\/.])/g,"\\$1").replace(/\*/g,"(.*)"),new RegExp("^"+e+"$",n?"":"i"))},_querystringToObject:function(e){for(var t,n=e.split("&"),r={},s=0;s<n.length;s++)t=n[s].split("="),t[1]&&(r[decodeURIComponent(t[0])]=decodeURIComponent(t[1]));return r},init:function(){return this.$.regexp=this._pathToRegEx(this.$.path,this.$.keys,this.$.options.sensitive,this.$.options.strict),this},match:function(e,t){var n=this.$.keys,r=e.split("?")[1]||null,s=e.indexOf("?"),i=~s?e.slice(0,s):e,o=this.$.regexp.exec(i);if(!o)return!1;for(var a,u,l=1;l<o.length;l++)a=n[l-1],u="string"==typeof o[l]?decodeURIComponent(o[l]):o[l],a?(a.name.toLowerCase(),t[a.name]=void 0!==t[a.name]?t[a.name]:u):t.push(u);return this.$.uri=i,this.$.params=t,this.$.query=null!==r?this._querystringToObject(r):null,!0}})}),define("src/Router",["./Base","./require","./Route"],function(e,t,n){return e.extend({_ctor:function(e){return this.$={base:null,context:null,data:{},location:null,name:null,params:null,query:null,routes:[],sensitive:!1,strict:!1},e&&_.extend(this.$,e),this},_dispatch:function(e,t){t=t||0;for(var n,r=this,s=this.$.routes,i=t;i<s.length;i++){if(n)return!0;if(n=s[i].route.match(e,[]),n===!0)return this.$.context=s[i].route.$,this.$.params=s[i].route.$.params,this.$.query=s[i].route.$.query,s[i].fn.call(r,{context:this.$.context,data:this.$.data,params:this.$.params,query:this.$.query},function(t){t&&_.extend(r.$.data,t);var n=i+1;"undefined"!=typeof s[n]&&r._dispatch(e,n)}),!0}return!1},end:function(){var e=this,n=function(){e.$.location=location;var t=""!==location.hash?location.hash:null,n=location.pathname;t&&(n+=t),this.$.context&&(n=this.$.context+n),e._dispatch(n)};return t(["hashchange"],function(){$(window).hashchange(n),n()}),this},navigateTo:function(e){e=e||"/";var t=null===this.get("base")?"":this.get("base");return e=t+e,window.location.replace(e),this},setRouteCallback:function(){var e=this,t=null===e.$.base?"":e.$.base,r=Array.prototype.slice.call(arguments),s=r[0];return("#/"===s||"/"===s)&&(s=t),s!==t&&(s=t+s),r.splice(0,1),_.each(r,function(t){e.$.routes.push({route:new n(s).init(),fn:function(n,r){t.call(e,n,r)}})}),this},now:function(){return this.navigateTo.apply(this,arguments)},add:function(){return this.setRouteCallback.apply(this,arguments)}})}),define("frog",["src/Api","src/Base","src/Collection","src/Component","src/date","src/Email","src/Events","src/Events.Singleton","src/Facebook","src/Flow","src/Handler.Form","src/Handler.Object","src/I18n","src/log","src/Model","src/require","src/Router","src/singleton","src/util","src/validations","src/View","src/xhr"],function(e,t,n,r,s,i,o,a,u,l,c,h,d,f,m,p,g,v,$,_,y,b){var E={Api:e,Base:t,Collection:n,Component:r,date:s,Email:i,Events:o,events:a,Facebook:u,Flow:l,Handler:{Form:c,Object:h},I18n:d,log:f,Model:m,require:p,Router:g,singleton:v,util:$,validations:_,View:y,xhr:b};return window.frog=E});